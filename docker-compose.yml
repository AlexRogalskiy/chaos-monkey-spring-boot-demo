version: '3'

networks:
  servicenet:
    driver: bridge

services:
####  DIFFY       #####
#  diffy:
#    image: camiloribeiro/twitter-diffy
#    ports:
#      - "8888:8888"
#      - "31900:31900"
#    links:
#      - primary
#      - secondary
#      - candidate
#    command: java -jar ./target/scala-2.11/diffy-server.jar -candidate='candidate:8080' -master.primary='primary:8080' -master.secondary='secondary:8080' -service.protocol='http' -serviceName='api-gateway' -proxy.port=:31900 -admin.port=:8881 -http.port=:8888 -rootUrl='localhost:8888'

##### PROD STACK  #####
  api-gateway-prod:
    image: mrbwilms/api-gateway
    ports:
    - "8080:8080"
    networks:
    - servicenet

  besteller-fashion-prod:
    image: mrbwilms/bestseller-fashion
    ports:
    - "8082:8082"
    networks:
    - servicenet

  bestseller-toys-prod:
    image: mrbwilms/bestseller-toys
    ports:
    - "8081:8081"
    networks:
    - servicenet

  hot-deals-prod:
    image: mrbwilms/hot-deals
    ports:
    - "8083:8083"
    networks:
    - servicenet
#####   SHADOW STACK #####
  api-gateway-shadow:
    image: mrbwilms/api-gateway
    ports:
    - "8080:9080"
    networks:
    - servicenet

  besteller-fashion-shadow:
    image: mrbwilms/bestseller-fashion
    ports:
    - "8082:9082"
    networks:
    - servicenet

  bestseller-toys-shadow:
    image: mrbwilms/bestseller-toys
    ports:
    - "8081:9081"
    networks:
    - servicenet

  hot-deals-shadow:
    image: mrbwilms/hot-deals
    ports:
    - "8083:9083"
    networks:
    - servicenet
